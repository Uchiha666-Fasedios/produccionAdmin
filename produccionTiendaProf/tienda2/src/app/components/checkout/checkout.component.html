<app-nav></app-nav>
<div class="ps-page--default">
    <div class="container">
      <div class="ps-page__header">
        <h3>Checkout</h3>
        <ul class="ps-breadcrumb">
          <li><a [routerLink]="['/']">Home</a></li>
          <li>Checkout</li>
        </ul>
      </div>
      <div class="ps-page__content">
        <div class="ps-checkout">
         
            <div class="row">
                <div class="col-md-6">
                  <ng-container *ngIf="direcciones.length == 0">
                      <div class="ps-form__billings">
                          <h4 class="ps-form__heading">{{'checkout.item_uno' | translate}}</h4>
                          <form #registroForm="ngForm" (ngSubmit)="registrar(registroForm)">
                            <div class="row">
                                <div class="col-sm-6 form-group">
                                    <label for="ac-fn">{{'session.item_ocho' | translate}}</label>
                                    <input type="text" required class="form-control form-control-lg" name="nombres" [(ngModel)]="direccion.nombres" placeholder="{{'perfil.item_siete' | translate}}">
                                </div>
                                <div class="col-sm-6 form-group">
                                    <label for="ac-fn">{{'session.item_nueve' | translate}}</label>
                                    <input type="text" required class="form-control form-control-lg" name="apellidos" [(ngModel)]="direccion.apellidos" placeholder="{{'perfil.item_ocho' | translate}}">
                                </div>
                                <div class="col-sm-6 form-group">
                                    <label for="ac-fn">{{'checkout.item_dos' | translate}}{{'perfil.item_trece' | translate}}
                                        <span *ngIf="currency != 'ARS'">{{'perfil.item_trece' | translate}} </span>
                                    </label>
                                    <input *ngIf="currency == 'ARS'" type="text" required class="form-control form-control-lg" name="dni" [(ngModel)]="direccion.dni" placeholder="{{'checkout.item_dos' | translate}}">
                                    <input *ngIf="currency != 'ARS'" type="text" class="form-control form-control-lg" name="dni" [(ngModel)]="direccion.dni" placeholder="{{'checkout.item_dos' | translate}}">
                                </div>
                                <div class="col-sm-6 form-group">
                                    <label for="ac-fn">{{'contacto.item_cuatro' | translate}}</label>
                                    <input type="text" required class="form-control form-control-lg" name="telefono" [(ngModel)]="direccion.telefono" placeholder="{{'contacto.item_cuatro' | translate}}">
                                </div>

                                <div class="col-sm-12 form-group">
                                    <label for="ac-fn">{{'perfil.item_diecisiete' | translate}}</label>
                                    <select class="form-control" name="str_pais" required [(ngModel)]="str_pais" (change)="select_pais()">
                                        <option value="" selected disabled>{{'carrito.item_diez' | translate}}</option>
                                        <ng-container *ngFor="let item of zonas">
                                            <ng-container  *ngIf="currency =='ARS'">
                                                <option value="{{item.country}}_{{item.zona}}" *ngIf="item.country =='Argentina'">{{item.country}}</option>
                                            </ng-container>
                                            <ng-container  *ngIf="currency !='ARS'">
                                                <option value="{{item.country}}_{{item.zona}}" *ngIf="item.country !='Argentina'">{{item.country}}</option>
                                            </ng-container>
                                           
                                        </ng-container>
                                    </select>
                                </div>
                                

                                <div class="col-sm-12 form-group">
                                    <label for="ac-fn">{{'perfil.item_quince' | translate}}</label>
                                    <textarea required class="form-control" placeholder="{{'perfil.item_quince' | translate}}" name="direccion" [(ngModel)]="direccion.direccion" rows="3"></textarea>
                                </div>

                                <div class="col-sm-12 form-group">
                                    <label for="ac-fn">{{'perfil.item_dieciseis' | translate}}
                                        <span *ngIf="currency != 'ARS'"> {{'perfil.item_trece' | translate}}</span>
                                    </label>
                                    <textarea *ngIf="currency == 'ARS'" type="text" required class="form-control" placeholder="{{'perfil.item_dieciseis' | translate}}" name="referencia" [(ngModel)]="direccion.referencia" rows="2"></textarea>
                                    <textarea *ngIf="currency != 'ARS'" type="text" class="form-control" placeholder="{{'perfil.item_dieciseis' | translate}}" name="referencia" [(ngModel)]="direccion.referencia" rows="2"></textarea>
                                </div>

                                <div class="col-sm-6 form-group">
                                    <label for="ac-fn">{{'perfil.item_catorce' | translate}}
                                        <span *ngIf="currency == 'ARS'"> {{'perfil.item_trece' | translate}}</span>
                                    </label>
                                    <input *ngIf="currency != 'ARS'" type="text" required class="form-control form-control-lg" name="zip" [(ngModel)]="direccion.zip" placeholder="{{'perfil.item_catorce' | translate}}">
                                    <input *ngIf="currency == 'ARS'" type="text" class="form-control form-control-lg" name="zip" [(ngModel)]="direccion.zip" placeholder="{{'perfil.item_catorce' | translate}}">
                                </div>
                                
                               
                                
                                <div class="col-sm-6 form-group" *ngIf="direccion.pais != 'Argentina'">
                                    <label for="ac-fn">{{'checkout.item_tres' | translate}}</label>
                                    <input type="text" required class="form-control form-control-lg" name="distrito" [(ngModel)]="direccion.distrito" placeholder="Ciudad">
                                </div>
                                <div class="col-sm-6 form-group" *ngIf="direccion.pais == 'Argentina'">
                                    <label for="ac-fn">{{'checkout.item_cuatro' | translate}}</label>
                                    <select id="sl-region"  name="region" [(ngModel)]="direccion.region" class="form-control" disabled (change)="select_region()">
                                        <option value="" selected disabled>{{'carrito.item_diez' | translate}}</option>
                                        <option value="{{item.id}}" *ngFor="let item of regiones">{{item.name}}</option>
                                    </select>
                                </div>
                                <div class="col-sm-6 form-group" *ngIf="direccion.pais == 'Argentina'">
                                    <label for="ac-fn">{{'perfil.item_veintiuno' | translate}}</label>
                                    <select id="sl-provincia" name="provincia" [(ngModel)]="direccion.provincia" class="form-control" disabled (change)="select_provincia()">
                                        <option value="" selected disabled>{{'carrito.item_diez' | translate}}</option>
                                        <option value="{{item.id}}" *ngFor="let item of provincias">{{item.name}}</option>
                                    </select>
                                </div>
                                <div class="col-sm-6 form-group" *ngIf="direccion.pais == 'Argentina'">
                                    <label for="ac-fn">{{'perfil.item_veintidos' | translate}}</label>
                                    <select id="sl-distrito" name="distrito" [(ngModel)]="direccion.distrito" class="form-control" disabled>
                                        <option value="" selected disabled>{{'carrito.item_diez' | translate}}</option>
                                        <option value="{{item.id}}" *ngFor="let item of distritos">{{item.name}}</option>
                                    </select>
                                </div>
                               
                                <div class="col-sm-12">
                                  <button type="submit" class="ps-btn ps-btn--fullwidth ps-btn--black">{{'checkout.item_cinco' | translate}}</button>
                                </div>
                                
                            </div>
                          </form>
                      </div>
                  </ng-container>
                  <ng-container  *ngIf="direcciones.length >= 1">
                      <h4 class="ps-form__heading" style="margin-bottom: 2rem!important;">{{'checkout.item_seis' | translate}}</h4>
  
                      <div class="card mb-3" *ngFor="let item of direcciones">
                          <div class="card-body">
                              <figure>
                                  <figcaption>{{item.destinatario}}</figcaption>
                                  <span class="d-block mb-3 font-size-sm text-muted">{{item.zip}}</span>
                          
                                  <div class="row">
                                      <div class="col" *ngIf="item.pais == 'Argentina'">
                                          <p>
                                              {{item.direccion}}
                                              <ng-container *ngIf="item.referencia">
                                                  <br>
                                                  {{item.referencia}}
                                              </ng-container>
                                              
                                          </p>
                                          <p>
                                            {{item.pais}}, {{item.region}}
                                           <br>
                                            <span>{{item.provincia}}, {{item.distrito}}</span>
                                          </p>
                                      </div>
                                      <div class="col" *ngIf="item.pais != 'Argentina'">
                                          <p>
                                              {{item.direccion}}
                                          </p>
                                          <p>
                                          {{item.pais}}, {{item.distrito}}
                                          </p>
                                          
                                      </div>
                                      <ng-container *ngIf="currency != 'ARS'">
                                        <a *ngIf="item.pais != 'Argentina'" class="text-success mt-4" style="cursor: pointer;margin-right: 2rem;" (click)="select_direccion_envio(item)">
                                            [{{'carrito.item_diez' | translate}}]
                                        </a>
                                        <a *ngIf="item.pais == 'Argentina'" class="text-danger mt-4" style="cursor: pointer;margin-right: 2rem;cursor: not-allowed;">
                                            [{{'carrito.item_diez' | translate}}]
                                        </a>
                                      </ng-container>
                                      <ng-container *ngIf="currency == 'ARS'">
                                        <a *ngIf="item.pais == 'Argentina'" class="text-success mt-4" style="cursor: pointer;margin-right: 2rem;" (click)="select_direccion_envio(item)">
                                            [{{'carrito.item_diez' | translate}}]
                                        </a>
                                        <a *ngIf="item.pais != 'Argentina'" class="text-danger mt-4" style="cursor: pointer;margin-right: 2rem;cursor: not-allowed;">
                                            [{{'carrito.item_diez' | translate}}]
                                        </a>
                                      </ng-container>
                                  </div>
                              </figure>
                          </div>
                      </div>

                        <figure style="margin-top: 30px;">
                            <a class="ps-btn ps-btn--outline" [routerLink]="['/cuenta/direcciones']" >{{'perfil.item_cinco' | translate}}</a>
  
                        </figure>
                  </ng-container>
                  <div class="ps-shopping-cart" style="margin-top: 5rem;">
                    <div class="ps-section__actions">
                        <div class="form-group">
                            <label style="color: #dc1d61 !important;">{{'checkout.item_siete' | translate}}</label>
                            <div class="form-group__content">
                                <input class="form-control" type="text" placeholder="{{'checkout.item_ocho' | translate}}" name="cupon" [(ngModel)]="venta.cupon">
                                <a style="cursor: pointer;" (click)="validar_cupon()" >{{'checkout.item_nueve' | translate}}</a>
                            </div>
                        </div>
                    </div>
                  </div>
                  
                  
                </div>
                <div class="col-md-6">
                  <div class="ps-form__orders">
                    <h3>{{'checkout.item_nueve' | translate}}</h3>
                    <div class="ps-block--checkout-order">
                        
                      <div class="ps-block__content">
                        <figure>
                          <figcaption><strong>{{'checkout.item_once' | translate}}</strong><strong>Subtotal</strong></figcaption>
                        </figure>
                        <figure class="ps-block__items">
                            <a [routerLink]="['/productos/',item.producto.slug]" *ngFor="let item of carrito_arr" style="font-size: 14px !important;">
                                <div class="ps-product--sidebar">
                                    <div class="ps-product__thumbnail" style="max-width: 40px;"><a class="ps-product__overlay" [routerLink]="['/productos/',item.producto.slug]"></a>
                                        <img [src]="url +'obtener_portada/'+item.producto.portada" alt="">
                                    </div>
                                    <div class="ps-product__content">
                                        <a class="ps-product__title" href="product-default.html" style="padding: 0px;">{{item.producto.titulo}}
                                            <span  style="margin-bottom: 0px;"> &nbsp;x{{item.cantidad}}</span></a>
                                        <p  style="margin-bottom: 0px;"> {{'checkout.item_doce' | translate}}: {{item.variedad.valor}}</p>
                                    </div>
                                </div>
                                
      
                                
                               

                                <small style="padding-top: 1rem;">
                                    <ng-container *ngIf="currency != 'ARS'">
                                        $USD/{{item.producto.precio_dolar*item.cantidad}}
                                    </ng-container>
                                    <ng-container *ngIf="currency == 'ARS'">
                                        $ARS/{{item.producto.precio*item.cantidad}}
                                    </ng-container>
                                </small>

                                
                            </a>
                        </figure>
                        <figure>
                          <figcaption><strong>Subtotal</strong>
                            <small>
                                <span *ngIf="currency != 'ARS'">$USD/{{subtotal}}</span>
                                <span *ngIf="currency == 'ARS'">$ARS/{{subtotal}}</span>
                            </small>
                        </figcaption>
                        </figure>
                        <figure class="ps-block__shipping">
                          <h3>{{'carrito.item_once' | translate}}</h3>
                          <p>{{'carrito.item_trece' | translate}}</p>
                        </figure>
                        
                        <figure class="ps-block__total">
                            <figcaption style="margin-top: 2rem;">
                                <span *ngIf="!envio_gratis">{{'carrito.item_once' | translate}}</span>
                                <span *ngIf="envio_gratis" style="color: #127c5f;"><b>{{'carrito.item_catorce' | translate}}</b></span>
                                <span>
                                    <span *ngIf="currency != 'ARS'">$USD/{{envio}}</span>
                                <span *ngIf="currency == 'ARS'">$ARS/{{envio}}</span>
                                </span>
                            </figcaption>
                        </figure>
                        <figure class="ps-block__total">
                            <figcaption style="margin-top: 2rem;">{{'perfil.item_treintadiecinueve' | translate}}
                                <span>
                                    <span *ngIf="currency != 'ARS'">- $USD/{{descuento}}</span>
                                <span *ngIf="currency == 'ARS'">- $ARS/{{descuento}}</span>
                                </span>
                            </figcaption>
                        </figure>
                        <figure class="ps-block__total">
                          <figcaption>Total
                              <span>
                                <span *ngIf="currency != 'ARS'">$USD/{{total_pagar}}</span>
                                <span *ngIf="currency == 'ARS'">$ARS/{{total_pagar}}</span>
                              </span>
                            </figcaption>
                        </figure>
                        <figure class="ps-block__payment-methods">
                            <ng-container *ngIf="currency == 'PEN'">
                                <div class="ps-radio" style="display: flex; justify-content: space-between;">
                                    <input class="form-control" type="radio" id="shipping-3" name="metodo_pago" [(ngModel)]="metodo_pago" value="{{'checkout.item_quince' | translate}}">
                                    <label for="shipping-3" class="text-muted"><b>{{'checkout.item_quince' | translate}}</b></label>

                                    <img src="assets/img/payments.png" style="width: 130px;">
                                </div>
                               <div class="ps-radio">
                                    <input class="form-control" type="radio" id="shipping-1" name="metodo_pago" [(ngModel)]="metodo_pago" value="Yape o Plin">
                                    <label for="shipping-1" class="text-muted"><b>{{'checkout.item_diecisiete' | translate}}</b></label>

                                    <p *ngIf="metodo_pago == 'Yape o Plin'" style="font-size: 13px;margin-bottom: 2.3rem;">{{'checkout.item_dieciocho' | translate}}</p>
                                </div> 
                                <div class="ps-radio">
                                    <input class="form-control" type="radio" id="shipping-2" name="metodo_pago" [(ngModel)]="metodo_pago" value="{{'checkout.item_diecinueve' | translate}}">
                                    <label for="shipping-2" class="text-muted"><b>{{'checkout.item_diecinueve' | translate}}</b></label>

                                    <p *ngIf="metodo_pago == 'Transferencia o Deposito'" style="font-size: 13px">{{'checkout.item_diecinueve' | translate}}</p>
                                </div>
                               
                            </ng-container>
                            
                        <p>{{'checkout.item_dieciseis' | translate}}</p>
                        <a [routerLink]="['/terminos-condiciones']"> <b> {{'checkout.item_veinte' | translate}}</b></a>
                        </figure>

                        <figure class="ps-block__payment-methods">
                            <ng-container *ngIf="currency == 'ARS'">
                                <div class="ps-radio" style="display: flex; justify-content: space-between;">
                                    <input class="form-control" type="radio" id="shipping-3" name="metodo_pago" [(ngModel)]="metodo_pago" value="{{'checkout.item_quince' | translate}}">
                                    <label for="shipping-3" class="text-muted"><b>{{'checkout.item_quince' | translate}}</b></label>

                                    <img src="assets/img/payments.png" style="width: 130px;">
                                </div>
                               <!--<div class="ps-radio">
                                    <input class="form-control" type="radio" id="shipping-1" name="metodo_pago" [(ngModel)]="metodo_pago" value="Yape o Plin">
                                    <label for="shipping-1" class="text-muted"><b>¡Paga al instante con Yape o Plin!</b></label>

                                    <p *ngIf="metodo_pago == 'Yape o Plin'" style="font-size: 13px;margin-bottom: 2.3rem;">(Luego de hacer click en "PROCESAR PEDIDO" podrás visualizar nuestros datos de pago).</p>
                                </div>--> 
                                <div class="ps-radio">
                                    <input class="form-control" type="radio" id="shipping-2" name="metodo_pago" [(ngModel)]="metodo_pago" value="{{'checkout.item_diecinueve' | translate}}">
                                    <label for="shipping-2" class="text-muted"><b>{{'checkout.item_diecinueve' | translate}}</b></label>

                                    <p *ngIf="metodo_pago == 'Transferencia o Deposito'" style="font-size: 13px">{{'checkout.item_dieciocho' | translate}}</p>
                                </div>
                               
                            </ng-container>
                            
                        <p>{{'checkout.item_dieciseis' | translate}}</p>
                        <a [routerLink]="['/terminos-condiciones']"> <b>  {{'checkout.item_veinte' | translate}}.</b></a>
                        </figure>

                      </div>
                      <div class="ps-block__footer">
                        <ng-container *ngIf="direccion_envio != undefined">
                            <ng-container *ngIf="carrito_arr.length >= 1">
                              <ng-container *ngIf="currency == 'ARS'">
                                <div class="ps-block__bottom" *ngIf="metodo_pago == 'Tarjeta de crédito'">
                                  <a *ngIf="!btn_load" class="ps-btn ps-btn--black" id="btnBuy" style="cursor: pointer;" (click)="get_token_culqi()">{{'checkout.item_veintiuno' | translate}}</a>
                                  <button *ngIf="btn_load" class="ps-btn ps-btn--black btnBuy" style="cursor: pointer;" disabled>{{'checkout.item_veintidos' | translate}}</button>
                                </div>
                                <div class="ps-block__bottom" *ngIf="metodo_pago == 'Yape o Plin'">
                                  <a *ngIf="!btn_load" class="ps-btn ps-btn--black" id="btnBuy" style="cursor: pointer;" (click)="generar_pedido('Yape o Plin')">Enviar pedido</a>
                                  <button *ngIf="btn_load" class="ps-btn ps-btn--black btnBuy" style="cursor: pointer;" disabled>{{'checkout.item_veintidos' | translate}}</button>
                                </div>
                                <div class="ps-block__bottom" *ngIf="metodo_pago == 'Transferencia o Deposito'">
                                  <a *ngIf="!btn_load" class="ps-btn ps-btn--black" id="btnBuy" style="cursor: pointer;" (click)="generar_pedido('Transferencia o Deposito')">Procesar pedido</a>
                                  <button *ngIf="btn_load" class="ps-btn ps-btn--black btnBuy" style="cursor: pointer;" disabled>{{'checkout.item_veintidos' | translate}}</button>
                                </div>

                                <div class="ps-block__bottom mt-2 mb-2 contmercadopago">
                                    <a *ngIf="!btn_load" class="ps-btn ps-btn--black" id="btnBuy" style="cursor: pointer;" (click)="get_token_culqi()">{{'checkout.item_veintiuno' | translate}} (mercado pago)</a>
                                    <button *ngIf="btn_load" class="ps-btn ps-btn--black btnBuy" style="cursor: pointer;" disabled>{{'checkout.item_veintidos' | translate}}</button>
                                </div>
                              </ng-container>
                              
                            </ng-container>
                        </ng-container>
                        
                        <div class="pt-3 pb-0 contpaypal" #paypalButton>
                        
                        </div>
                        
                      </div>
                    </div>
                  </div>
                </div>
              </div>
        </div>
      </div>
    </div>
  </div>
<app-footer></app-footer>
